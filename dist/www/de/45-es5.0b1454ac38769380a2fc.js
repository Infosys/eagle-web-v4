/*               "Copyright 2020 Infosys Ltd.
               Use of this source code is governed by GPL v3 license that can be found in the LICENSE file or at https://opensource.org/licenses/GPL-3.0
               This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License version 3"*/
(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{Gyhq:function(t,e,n){"use strict";n.r(e);var r=n("CcnG"),o=function(){return function(){}}(),i=n("pMnS"),s=n("mrSG"),a=n("FISf"),c=n("PnTj"),u=function(){function t(t,e,n){this.videoSvc=t,this.route=e,this.viewerSvc=n,this.resourceEnded=new r.EventEmitter,this.hasErrorLoadingVideo=!1}return t.prototype.ngOnInit=function(){return s.__awaiter(this,void 0,void 0,function(){var t=this;return s.__generator(this,function(e){return this.paramSubscription=this.route.data.subscribe(function(e){t.processedContent=e.playerDetails.processedResource,t.collectionId=e.playerDetails.toc.identifier,t.onInItFunction()}),[2]})})},t.prototype.onInItFunction=function(){return s.__awaiter(this,void 0,void 0,function(){return s.__generator(this,function(t){switch(t.label){case 0:return this.processedContent&&this.processedContent.content&&this.processedContent.video?[4,this.loadPlayer()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.loadPlayer=function(){return s.__awaiter(this,void 0,void 0,function(){var t,e,n,r,o=this;return s.__generator(this,function(i){switch(i.label){case 0:return this.disposePlayer(),t={},this.processedContent.content.subTitles&&this.processedContent.content.subTitles.length&&(t=this.processedContent.content.subTitles.reduce(function(t,e){return t[e.srclang]=e.url,t},{})),e="amp_plugin_"+Date.now()+"_"+this.processedContent.content.identifier,n=this.viewerSvc.resumePointStringToProgressNumber(this.processedContent.resumeData),this.videoContainer.nativeElement.innerHTML='<video id="'+e+'" class="azuremediaplayer amp-flush-skin amp-big-play-centered"></video>',r=this,[4,this.videoSvc.init(e,this.processedContent.video.file,this.processedContent.video.streamingToken,this.processedContent.video.manifest,this.processedContent.content.appIcon,this.processedContent.content.identifier,this.processedContent.content.contentType,this.processedContent.content.mimeType,this.collectionId,n,[],t,{autoplay:!0,enableContinueLearning:!0})];case 1:return r.player=i.sent(),this.player.addEventListener("error",function(){console.warn("error occurred while playing video in AMP >",o.player.error()),o.hasErrorLoadingVideo||(console.warn("Failed loading video in AMP. Trying playback with file"),o.hasErrorLoadingVideo=!0,o.processedContent.video.streamingToken=void 0,o.processedContent.video.manifest=void 0,o.loadPlayer())}),this.player.addEventListener("ended",function(){o.resourceEnded.emit()}),[2]}})})},t.prototype.disposePlayer=function(){this.player&&"function"==typeof this.player.dispose&&this.player.dispose()},t.prototype.ngOnDestroy=function(){this.disposePlayer()},t}(),d=n("ZYCi"),h=r["\u0275crt"]({encapsulation:0,styles:[[".video-container[_ngcontent-%COMP%]{height:100%}"]],data:{}});function p(t){return r["\u0275vid"](0,[r["\u0275qud"](402653184,1,{videoContainer:0}),(t()(),r["\u0275eld"](1,0,[[1,0],["videoContainer",1]],null,0,"div",[["class","video-container"]],null,null,null,null,null))],null,null)}function l(t){return r["\u0275vid"](0,[(t()(),r["\u0275eld"](0,0,null,null,1,"ws-video",[],null,null,null,p,h)),r["\u0275did"](1,245760,null,0,u,[a.a,d.a,c.a],null,null)],function(t,e){t(e,1,0)},null)}var f=r["\u0275ccf"]("ws-video",u,l,{},{resourceEnded:"resourceEnded"},[]),v=n("Ip0R"),_=n("zsyL"),m=n("RB3e"),y=function(){return function(){}}();n.d(e,"VideoModuleNgFactory",function(){return C});var C=r["\u0275cmf"](o,[],function(t){return r["\u0275mod"]([r["\u0275mpd"](512,r.ComponentFactoryResolver,r["\u0275CodegenComponentFactoryResolver"],[[8,[i.a,f]],[3,r.ComponentFactoryResolver],r.NgModuleRef]),r["\u0275mpd"](4608,v.q,v.p,[r.LOCALE_ID,[2,v.L]]),r["\u0275mpd"](4608,_.a,_.a,[m.a]),r["\u0275mpd"](1073742336,v.c,v.c,[]),r["\u0275mpd"](1073742336,d.s,d.s,[[2,d.x],[2,d.o]]),r["\u0275mpd"](1073742336,y,y,[]),r["\u0275mpd"](1073742336,o,o,[]),r["\u0275mpd"](256,r.LOCALE_ID,"de",[]),r["\u0275mpd"](1024,d.m,function(){return[[{path:"",pathMatch:"full",component:u,resolve:{playerDetails:_.a}}]]},[]),r["\u0275mpd"](256,r.TRANSLATIONS_FORMAT,"xlf",[])])})},Jmk9:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("XlPw"),o=n("VX4o"),i=n("CcnG"),s=n("t/Na"),a=function(){function t(t,e){this.http=t,this.telemetrySvc=e,this.API_BASE="/clientApi/v2",this.USER_API=this.API_BASE+"/user",this.apiEndpoints={USER_HISTORY:this.USER_API+"/history",USER_CONTINUE_LEARNING:this.USER_API+"/history/continue"}}return t.prototype.fetchContinueLearning=function(t,e,n){return this.http.get(this.apiEndpoints.USER_CONTINUE_LEARNING+"?pageSize="+t+(e?"&pageState="+e:"")+(n?"&email="+n:""))},t.prototype.saveContinueLearning=function(t,e){var n=this.apiEndpoints.USER_CONTINUE_LEARNING;return Object.keys(t).length?this.http.post(n,t):(this.telemetrySvc.errorTelemetryEvent(n,t,e),Object(r.a)({message:"EMPTY_REQUEST"}))},t.prototype.fetchContentContinueLearning=function(t){return this.http.get(this.apiEndpoints.USER_CONTINUE_LEARNING+"/"+t)},t.prototype.addHistory=function(t){return this.http.post(this.apiEndpoints.USER_HISTORY+"/"+t,{})},t.prototype.deleteHistory=function(t){return this.http.delete(this.apiEndpoints.USER_HISTORY+"/"+t)},t.ngInjectableDef=i["\u0275\u0275defineInjectable"]({factory:function(){return new t(i["\u0275\u0275inject"](s.c),i["\u0275\u0275inject"](o.a))},token:t,providedIn:"root"}),t}()},PnTj:function(t,e,n){"use strict";var r=n("mrSG"),o=n("bne5"),i=n("VnD/"),s=n("5DKC"),a=n("F/XL"),c=n("9Z1F"),u=n("CcnG"),d=n("t/Na"),h=function(){function t(t){this.http=t,this.apiEndpoints={setCookie:s.c+"/videojs/setCookie",setS3Cookie:s.d+"/setS3Cookie/setCookie"}}return t.prototype.setVideoCookie=function(t){return this.http.post(this.apiEndpoints.setCookie,{path:t}).pipe(Object(c.a)(function(t){return Object(a.a)(!0)}))},t.prototype.setS3Cookie=function(t){return this.http.post(this.apiEndpoints.setS3Cookie,{path:t}).pipe(Object(c.a)(function(t){return Object(a.a)(!0)}))},t.ngInjectableDef=u["\u0275\u0275defineInjectable"]({factory:function(){return new t(u["\u0275\u0275inject"](d.c))},token:t,providedIn:"root"}),t}(),p=n("hFHK"),l=n("NBun"),f=n("oVAt"),v=n("vPp1");n.d(e,"a",function(){return y});var _=new Set(Object.values(p.a)),m=function(t){function e(e){var n=t.call(this,e)||this;return n.code=e,n}return r.__extends(e,t),e}(Error),y=function(){function t(t,e,n,r,o){this.http=t,this.contentSvc=e,this.miscSvc=n,this.historySvc=r,this.s3ContentApi=o,this.initGlobalDataRequestResponder()}return t.prototype.updateViewCountAndHistoryOnLoad=function(t,e){this.contentSvc.updateViewCount(e).toPromise(),t&&t!==e&&this.historySvc.saveContinueLearning({contextPathId:t,resourceId:e,percentComplete:0,data:JSON.stringify({timestamp:Date.now()})},e).toPromise().catch(function(t){return console.warn(t)}),this.historySvc.addToHistory(e)},t.prototype.processResponse=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,o,i,s,a;return r.__generator(this,function(r){switch(r.label){case 0:e={id:t.id,data:null},n=this.resumePoint(t.contentId),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.fetchContentAndValidate(t.contentId)];case 2:return o=r.sent(),i=e,[4,this.transformContent(o)];case 3:return i.data=r.sent(),s=e.data,[4,n];case 4:return s.resumeData=r.sent(),[3,6];case 5:return a=r.sent(),e.error=a.code||"UNKNOWN_ERROR",[3,6];case 6:return[2,e]}})})},t.prototype.fetchContentAndValidate=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.contentSvc.fetchContent(t).toPromise()];case 1:if("Resource"!==(e=r.sent()).contentType&&"Knowledge Artifact"!==e.contentType)throw new m("INVALID_RESOURCE");if(!_.has(e.mimeType))throw new m("INVALID_MIME");return[2,e];case 2:throw n=r.sent(),new m(n&&n.code||"UNKNOWN_ERROR");case 3:return[2]}})})},t.prototype.transformContent=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,o,i,s,a,c,u,d;return r.__generator(this,function(h){switch(h.label){case 0:return t.artifactUrl.indexOf("content-store")>=0?[4,this.setS3Cookie(t.artifactUrl)]:[3,2];case 1:h.sent(),h.label=2;case 2:if("Certification"===t.resourceType)return[2,{content:r.__assign({},t,{mimeType:p.a.certification})}];switch(t.mimeType){case p.a.mp4:return[3,3];case p.a.m3u8:return[3,5];case p.a.quiz:return[3,7];case p.a.webModule:case p.a.webModuleExercise:return[3,9];case p.a.collectionResource:return[3,11];case p.a.handson:return[3,13];case p.a.classDiagram:return[3,15];case p.a.rdbms:return[3,17];case p.a.interaction:return[3,19]}return[3,22];case 3:return[4,this.transformVideo(t)];case 4:return e=h.sent(),[2,{content:t,video:e}];case 5:return[4,this.setVideojsCookie(t.artifactUrl)];case 6:return h.sent(),[2,{content:t}];case 7:return[4,this.transformQuiz(t)];case 8:return n=h.sent(),[2,{content:t,quiz:n}];case 9:return[4,this.transformWebModule(t)];case 10:return o=h.sent(),[2,{content:t,webModule:o}];case 11:return[4,this.transformCollectionResource(t)];case 12:return i=h.sent(),[2,{content:t,collectionResource:i}];case 13:return[4,this.transformHandsOn(t)];case 14:return s=h.sent(),[2,{content:t,handsOn:s}];case 15:return[4,this.transformClassDiagram(t)];case 16:return a=h.sent(),[2,{content:t,classDiagram:a}];case 17:return[4,this.transformDbmsModule(t)];case 18:return c=h.sent(),[2,{content:t,rdbms:c}];case 19:return[4,this.transformInteractions(t)];case 20:return u=h.sent(),[4,this.transformVideo(t)];case 21:return d=h.sent(),[2,{content:t,interactions:u,video:d}];case 22:return[2,{content:t}]}})})},t.prototype.transformVideo=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,o;return r.__generator(this,function(r){switch(r.label){case 0:if(e={file:t.artifactUrl,streamingToken:null,manifest:null},!(t.msArtifactDetails&&t.msArtifactDetails.channelId&&t.msArtifactDetails.videoId))return[2,e];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.miscSvc.fetchVideoTokens(t.msArtifactDetails.channelId,t.msArtifactDetails.videoId).toPromise()];case 2:return n=r.sent(),o=n.manifest,e.streamingToken=n.streamingToken,e.manifest=o,[2,e];case 3:return r.sent(),[3,4];case 4:return[2,e]}})})},t.prototype.transformQuiz=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new m("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformHandsOn=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new m("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformClassDiagram=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new m("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformDbmsModule=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise()];case 1:return[2,e.sent()]}})})},t.prototype.transformWebModule=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new m("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformCollectionResource=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new m("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformInteractions=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new m("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.resumePoint=function(t){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.historySvc.fetchContentContinueLearning(t).toPromise()];case 1:return(e=n.sent())&&Array.isArray(e.results)&&e.results.length>0&&e.results[0].continueLearningData?[2,e.results[0].continueLearningData.data]:[3,3];case 2:return n.sent(),[3,3];case 3:return[2,null]}})})},t.prototype.setVideojsCookie=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.s3ContentApi.setVideoCookie(t).toPromise().catch(function(t){throw new m("COOKIE_SET_FAILURE")})];case 1:return e.sent(),[2]}})})},t.prototype.setS3Cookie=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.s3ContentApi.setS3Cookie(t).toPromise().catch(function(t){throw new m("COOKIE_SET_FAILURE")})];case 1:return e.sent(),[2]}})})},t.prototype.initGlobalDataRequestResponder=function(){var t=this;Object(o.a)(window,"message").pipe(Object(i.a)(function(t){return t&&t.data&&"DATA_REQUEST"===t.data.type&&Boolean(t.data.data.contentId)&&Boolean(t.source)&&"function"==typeof t.source.postMessage})).subscribe(function(e){return r.__awaiter(t,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.source,[4,this.processResponse(e.data.data)];case 1:return n=r.sent(),t.postMessage({app:"WEB_PLAYER",data:n,plugin:"NONE",state:"NONE",type:"DATA_RESPONSE"},"*"),[2]}})})})},t.prototype.resumePointStringToProgressNumber=function(t){try{var e=JSON.parse(t),n=parseInt(e.progress.toString(),10);return Number.isNaN(n)||Math.round(n)!==n?0:n}catch(r){return 0}},t.ngInjectableDef=u["\u0275\u0275defineInjectable"]({factory:function(){return new t(u["\u0275\u0275inject"](d.c),u["\u0275\u0275inject"](l.a),u["\u0275\u0275inject"](v.a),u["\u0275\u0275inject"](f.a),u["\u0275\u0275inject"](h))},token:t,providedIn:"root"}),t}()},oVAt:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n("Jmk9"),o=n("CcnG"),i=function(){function t(t){this.historyApiSvc=t}return t.prototype.fetchContinueLearning=function(t,e,n){return this.historyApiSvc.fetchContinueLearning(t,e,n)},t.prototype.fetchContentContinueLearning=function(t){return this.historyApiSvc.fetchContentContinueLearning(t)},t.prototype.saveContinueLearning=function(t,e){return this.historyApiSvc.saveContinueLearning(t,e)},t.prototype.addToHistory=function(t){return this.historyApiSvc.addHistory(t)},t.ngInjectableDef=o["\u0275\u0275defineInjectable"]({factory:function(){return new t(o["\u0275\u0275inject"](r.a))},token:t,providedIn:"root"}),t}()},xXU7:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n("6blF"),o=n("T1DM"),i=n("/21U");function s(t,e){return void 0===t&&(t=0),void 0===e&&(e=o.a),(!Object(i.a)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=o.a),new r.a(function(n){return n.add(e.schedule(a,t,{subscriber:n,counter:0,period:t})),n})}function a(t){var e=t.subscriber,n=t.counter,r=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}}}]);