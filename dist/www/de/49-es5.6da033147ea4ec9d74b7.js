/*               "Copyright 2020 Infosys Ltd.
               Use of this source code is governed by GPL v3 license that can be found in the LICENSE file or at https://opensource.org/licenses/GPL-3.0
               This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License version 3"*/
(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{Jmk9:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n("XlPw"),i=n("VX4o"),o=n("CcnG"),s=n("t/Na"),a=function(){function t(t,e){this.http=t,this.telemetrySvc=e,this.API_BASE="/clientApi/v2",this.USER_API=this.API_BASE+"/user",this.apiEndpoints={USER_HISTORY:this.USER_API+"/history",USER_CONTINUE_LEARNING:this.USER_API+"/history/continue"}}return t.prototype.fetchContinueLearning=function(t,e,n){return this.http.get(this.apiEndpoints.USER_CONTINUE_LEARNING+"?pageSize="+t+(e?"&pageState="+e:"")+(n?"&email="+n:""))},t.prototype.saveContinueLearning=function(t,e){var n=this.apiEndpoints.USER_CONTINUE_LEARNING;return Object.keys(t).length?this.http.post(n,t):(this.telemetrySvc.errorTelemetryEvent(n,t,e),Object(r.a)({message:"EMPTY_REQUEST"}))},t.prototype.fetchContentContinueLearning=function(t){return this.http.get(this.apiEndpoints.USER_CONTINUE_LEARNING+"/"+t)},t.prototype.addHistory=function(t){return this.http.post(this.apiEndpoints.USER_HISTORY+"/"+t,{})},t.prototype.deleteHistory=function(t){return this.http.delete(this.apiEndpoints.USER_HISTORY+"/"+t)},t.ngInjectableDef=o["\u0275\u0275defineInjectable"]({factory:function(){return new t(o["\u0275\u0275inject"](s.c),o["\u0275\u0275inject"](i.a))},token:t,providedIn:"root"}),t}()},PnTj:function(t,e,n){"use strict";var r=n("mrSG"),i=n("bne5"),o=n("VnD/"),s=n("5DKC"),a=n("F/XL"),c=n("9Z1F"),u=n("CcnG"),h=n("t/Na"),p=function(){function t(t){this.http=t,this.apiEndpoints={setCookie:s.c+"/videojs/setCookie",setS3Cookie:s.d+"/setS3Cookie/setCookie"}}return t.prototype.setVideoCookie=function(t){return this.http.post(this.apiEndpoints.setCookie,{path:t}).pipe(Object(c.a)(function(t){return Object(a.a)(!0)}))},t.prototype.setS3Cookie=function(t){return this.http.post(this.apiEndpoints.setS3Cookie,{path:t}).pipe(Object(c.a)(function(t){return Object(a.a)(!0)}))},t.ngInjectableDef=u["\u0275\u0275defineInjectable"]({factory:function(){return new t(u["\u0275\u0275inject"](h.c))},token:t,providedIn:"root"}),t}(),l=n("hFHK"),f=n("NBun"),d=n("oVAt"),m=n("vPp1");n.d(e,"a",function(){return y});var g=new Set(Object.values(l.a)),_=function(t){function e(e){var n=t.call(this,e)||this;return n.code=e,n}return r.__extends(e,t),e}(Error),y=function(){function t(t,e,n,r,i){this.http=t,this.contentSvc=e,this.miscSvc=n,this.historySvc=r,this.s3ContentApi=i,this.initGlobalDataRequestResponder()}return t.prototype.updateViewCountAndHistoryOnLoad=function(t,e){this.contentSvc.updateViewCount(e).toPromise(),t&&t!==e&&this.historySvc.saveContinueLearning({contextPathId:t,resourceId:e,percentComplete:0,data:JSON.stringify({timestamp:Date.now()})},e).toPromise().catch(function(t){return console.warn(t)}),this.historySvc.addToHistory(e)},t.prototype.processResponse=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,i,o,s,a;return r.__generator(this,function(r){switch(r.label){case 0:e={id:t.id,data:null},n=this.resumePoint(t.contentId),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.fetchContentAndValidate(t.contentId)];case 2:return i=r.sent(),o=e,[4,this.transformContent(i)];case 3:return o.data=r.sent(),s=e.data,[4,n];case 4:return s.resumeData=r.sent(),[3,6];case 5:return a=r.sent(),e.error=a.code||"UNKNOWN_ERROR",[3,6];case 6:return[2,e]}})})},t.prototype.fetchContentAndValidate=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.contentSvc.fetchContent(t).toPromise()];case 1:if("Resource"!==(e=r.sent()).contentType&&"Knowledge Artifact"!==e.contentType)throw new _("INVALID_RESOURCE");if(!g.has(e.mimeType))throw new _("INVALID_MIME");return[2,e];case 2:throw n=r.sent(),new _(n&&n.code||"UNKNOWN_ERROR");case 3:return[2]}})})},t.prototype.transformContent=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,i,o,s,a,c,u,h;return r.__generator(this,function(p){switch(p.label){case 0:return t.artifactUrl.indexOf("content-store")>=0?[4,this.setS3Cookie(t.artifactUrl)]:[3,2];case 1:p.sent(),p.label=2;case 2:if("Certification"===t.resourceType)return[2,{content:r.__assign({},t,{mimeType:l.a.certification})}];switch(t.mimeType){case l.a.mp4:return[3,3];case l.a.m3u8:return[3,5];case l.a.quiz:return[3,7];case l.a.webModule:case l.a.webModuleExercise:return[3,9];case l.a.collectionResource:return[3,11];case l.a.handson:return[3,13];case l.a.classDiagram:return[3,15];case l.a.rdbms:return[3,17];case l.a.interaction:return[3,19]}return[3,22];case 3:return[4,this.transformVideo(t)];case 4:return e=p.sent(),[2,{content:t,video:e}];case 5:return[4,this.setVideojsCookie(t.artifactUrl)];case 6:return p.sent(),[2,{content:t}];case 7:return[4,this.transformQuiz(t)];case 8:return n=p.sent(),[2,{content:t,quiz:n}];case 9:return[4,this.transformWebModule(t)];case 10:return i=p.sent(),[2,{content:t,webModule:i}];case 11:return[4,this.transformCollectionResource(t)];case 12:return o=p.sent(),[2,{content:t,collectionResource:o}];case 13:return[4,this.transformHandsOn(t)];case 14:return s=p.sent(),[2,{content:t,handsOn:s}];case 15:return[4,this.transformClassDiagram(t)];case 16:return a=p.sent(),[2,{content:t,classDiagram:a}];case 17:return[4,this.transformDbmsModule(t)];case 18:return c=p.sent(),[2,{content:t,rdbms:c}];case 19:return[4,this.transformInteractions(t)];case 20:return u=p.sent(),[4,this.transformVideo(t)];case 21:return h=p.sent(),[2,{content:t,interactions:u,video:h}];case 22:return[2,{content:t}]}})})},t.prototype.transformVideo=function(t){return r.__awaiter(this,void 0,void 0,function(){var e,n,i;return r.__generator(this,function(r){switch(r.label){case 0:if(e={file:t.artifactUrl,streamingToken:null,manifest:null},!(t.msArtifactDetails&&t.msArtifactDetails.channelId&&t.msArtifactDetails.videoId))return[2,e];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.miscSvc.fetchVideoTokens(t.msArtifactDetails.channelId,t.msArtifactDetails.videoId).toPromise()];case 2:return n=r.sent(),i=n.manifest,e.streamingToken=n.streamingToken,e.manifest=i,[2,e];case 3:return r.sent(),[3,4];case 4:return[2,e]}})})},t.prototype.transformQuiz=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new _("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformHandsOn=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new _("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformClassDiagram=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new _("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformDbmsModule=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise()];case 1:return[2,e.sent()]}})})},t.prototype.transformWebModule=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new _("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformCollectionResource=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new _("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.transformInteractions=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.http.get(t.artifactUrl).toPromise().catch(function(t){throw new _("MANIFEST_FETCH_FAILED")})];case 1:return[2,e.sent()]}})})},t.prototype.resumePoint=function(t){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.historySvc.fetchContentContinueLearning(t).toPromise()];case 1:return(e=n.sent())&&Array.isArray(e.results)&&e.results.length>0&&e.results[0].continueLearningData?[2,e.results[0].continueLearningData.data]:[3,3];case 2:return n.sent(),[3,3];case 3:return[2,null]}})})},t.prototype.setVideojsCookie=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.s3ContentApi.setVideoCookie(t).toPromise().catch(function(t){throw new _("COOKIE_SET_FAILURE")})];case 1:return e.sent(),[2]}})})},t.prototype.setS3Cookie=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this.s3ContentApi.setS3Cookie(t).toPromise().catch(function(t){throw new _("COOKIE_SET_FAILURE")})];case 1:return e.sent(),[2]}})})},t.prototype.initGlobalDataRequestResponder=function(){var t=this;Object(i.a)(window,"message").pipe(Object(o.a)(function(t){return t&&t.data&&"DATA_REQUEST"===t.data.type&&Boolean(t.data.data.contentId)&&Boolean(t.source)&&"function"==typeof t.source.postMessage})).subscribe(function(e){return r.__awaiter(t,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.source,[4,this.processResponse(e.data.data)];case 1:return n=r.sent(),t.postMessage({app:"WEB_PLAYER",data:n,plugin:"NONE",state:"NONE",type:"DATA_RESPONSE"},"*"),[2]}})})})},t.prototype.resumePointStringToProgressNumber=function(t){try{var e=JSON.parse(t),n=parseInt(e.progress.toString(),10);return Number.isNaN(n)||Math.round(n)!==n?0:n}catch(r){return 0}},t.ngInjectableDef=u["\u0275\u0275defineInjectable"]({factory:function(){return new t(u["\u0275\u0275inject"](h.c),u["\u0275\u0275inject"](f.a),u["\u0275\u0275inject"](m.a),u["\u0275\u0275inject"](d.a),u["\u0275\u0275inject"](p))},token:t,providedIn:"root"}),t}()},"U+en":function(t,e,n){"use strict";n.r(e);var r=n("CcnG"),i=function(){return function(){}}(),o=n("pMnS"),s=n("mrSG"),a=n("bne5"),c=n("VnD/"),u=n("67Y/"),h=n("hFHK"),p=n("qfBg"),l=n("r4Kj"),f=n("oVAt"),d=n("PnTj"),m=function(){function t(t,e,n,r,i,o,s){this.route=t,this.router=e,this.domSanitizer=n,this.viewerSvc=r,this.historySvc=i,this.userSvc=o,this.configSvc=s,this.maxLastPageNumber=0,this.realTimeProgressRequest={content_type:"Resource",current:[],max_size:0,mime_type:h.a.pdf,user_id_type:"uuid"},this.hasFiredRealTimeProgress=!1}return t.prototype.ngOnInit=function(){var t=this;this.paramSubscription=this.route.data.subscribe(function(e){t.processedContent=e.playerDetails.processedResource,t.collectionId=e.playerDetails.toc.identifier,t.iframeUrlSet()})},t.prototype.ngOnChanges=function(){if(this.processedContent&&this.processedContent.content){this.pageChangeHandler(),this.iframeUrl=null,this.maxLastPageNumber=0;var t=this.getUrl();t&&(this.iframeUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(t))}},t.prototype.iframeUrlSet=function(){if(this.processedContent&&this.processedContent.content){this.pageChangeHandler(),this.iframeUrl=null,this.maxLastPageNumber=0;var t=this.getUrl();t&&(this.iframeUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(t))}},t.prototype.pageChangeHandler=function(){var t=this;this.pageChangeSubscription=Object(a.a)(window,"message").pipe(Object(c.a)(function(t){return t&&t.data&&"TELEMETRY"===t.data.type}),Object(u.a)(function(t){return t.data}),Object(c.a)(function(t){return"SLIDE_CHANGE"===t.state||"LOADED"===t.state}),Object(u.a)(function(t){return t.data})).subscribe(function(e){e.pageNumber&&e.pageNumber>t.maxLastPageNumber&&(t.maxLastPageNumber=e.pageNumber),t.configSvc.instanceConfig.platform.updateRealTimeProgress&&t.raiseRealTimeProgress(e),t.historySvc.saveContinueLearning({contextPathId:t.processedContent.content.identifier,resourceId:t.processedContent.content.identifier,percentComplete:e.total&&e.total>0?Math.round(100*t.maxLastPageNumber/e.total):100,data:JSON.stringify({progress:e.pageNumber||t.maxLastPageNumber,timestamp:Date.now()})},t.processedContent.content.identifier).toPromise().catch(function(t){return console.warn(t)})})},t.prototype.raiseRealTimeProgress=function(t){var e=this,n=this.realTimeProgressRequest.current.slice();this.realTimeProgressRequest=s.__assign({},this.realTimeProgressRequest,{current:Array.from(new Set(this.realTimeProgressRequest.current.concat([t.pageNumber.toString()]))),max_size:t.total}),n.length===this.realTimeProgressRequest.current.length&&this.realTimeProgressRequest.current.every(function(t,e){return t===n[e]})||(this.realTimeProgressTimer&&clearTimeout(this.realTimeProgressTimer),this.hasFiredRealTimeProgress=!1,this.realTimeProgressTimer=setTimeout(function(){e.hasFiredRealTimeProgress=!0,e._fireRealTimeProgress()},12e4))},t.prototype._fireRealTimeProgress=function(){this.realTimeProgressRequest.current.length&&(this.realTimeProgressRequest.content_type=this.processedContent.content.contentType,this.userSvc.realTimeProgressUpdate(this.processedContent.content.identifier,this.realTimeProgressRequest).subscribe())},t.prototype.getUrl=function(){var t,e=this.viewerSvc.resumePointStringToProgressNumber(this.processedContent.resumeData);return this.processedContent&&this.processedContent.content&&this.processedContent.content.artifactUrl&&(t=this.processedContent.content.artifactUrl),t?"/public-assets/common/plugins/pdf/web/viewer.html?file="+encodeURIComponent(t)+"&contentId="+this.processedContent.content.identifier+(this.collectionId?"&courseId="+this.collectionId:"")+(e?"&startFrom="+e:""):null},t.prototype.ngOnDestroy=function(){!this.hasFiredRealTimeProgress&&this.configSvc.instanceConfig.platform.updateRealTimeProgress&&(this._fireRealTimeProgress(),this.realTimeProgressTimer&&clearTimeout(this.realTimeProgressTimer)),this.pageChangeSubscription&&this.pageChangeSubscription.unsubscribe()},t}(),g=n("ZYCi"),_=n("ZYjt"),y=r["\u0275crt"]({encapsulation:0,styles:[[".pdf-iframe[_ngcontent-%COMP%]{display:block;width:100%;height:100%;border:0}"]],data:{}});function v(t){return r["\u0275vid"](0,[(t()(),r["\u0275eld"](0,0,null,null,0,"iframe",[["allow","fullscreen; accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"],["class","pdf-iframe"],["frameborder","0"],["title","PDF-Betrachter"]],[[8,"src",5]],null,null,null,null))],null,function(t,e){t(e,0,0,e.component.iframeUrl)})}function C(t){return r["\u0275vid"](0,[(t()(),r["\u0275eld"](0,0,null,null,1,"ws-pdf",[],null,null,null,v,y)),r["\u0275did"](1,770048,null,0,m,[g.a,g.o,_.b,d.a,f.a,p.a,l.a],null,null)],function(t,e){t(e,1,0)},null)}var b=r["\u0275ccf"]("ws-pdf",m,C,{},{},[]),w=n("Ip0R"),S=n("zsyL"),T=n("RB3e"),E=function(){return function(){}}();n.d(e,"PdfModuleNgFactory",function(){return R});var R=r["\u0275cmf"](i,[],function(t){return r["\u0275mod"]([r["\u0275mpd"](512,r.ComponentFactoryResolver,r["\u0275CodegenComponentFactoryResolver"],[[8,[o.a,b]],[3,r.ComponentFactoryResolver],r.NgModuleRef]),r["\u0275mpd"](4608,w.q,w.p,[r.LOCALE_ID,[2,w.L]]),r["\u0275mpd"](4608,S.a,S.a,[T.a]),r["\u0275mpd"](1073742336,w.c,w.c,[]),r["\u0275mpd"](1073742336,g.s,g.s,[[2,g.x],[2,g.o]]),r["\u0275mpd"](1073742336,E,E,[]),r["\u0275mpd"](1073742336,i,i,[]),r["\u0275mpd"](256,r.LOCALE_ID,"de",[]),r["\u0275mpd"](1024,g.m,function(){return[[{path:"",pathMatch:"full",component:m,resolve:{playerDetails:S.a}}]]},[]),r["\u0275mpd"](256,r.TRANSLATIONS_FORMAT,"xlf",[])])})},oVAt:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n("Jmk9"),i=n("CcnG"),o=function(){function t(t){this.historyApiSvc=t}return t.prototype.fetchContinueLearning=function(t,e,n){return this.historyApiSvc.fetchContinueLearning(t,e,n)},t.prototype.fetchContentContinueLearning=function(t){return this.historyApiSvc.fetchContentContinueLearning(t)},t.prototype.saveContinueLearning=function(t,e){return this.historyApiSvc.saveContinueLearning(t,e)},t.prototype.addToHistory=function(t){return this.historyApiSvc.addHistory(t)},t.ngInjectableDef=i["\u0275\u0275defineInjectable"]({factory:function(){return new t(i["\u0275\u0275inject"](r.a))},token:t,providedIn:"root"}),t}()}}]);